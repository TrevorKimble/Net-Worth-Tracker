// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Monthly Input Table - Simple estimates
model MonthlyInput {
  id        Int      @id @default(autoincrement())
  month     Int      // 1-12
  year      Int
  cash      Float    @default(0)
  stocks    Float    @default(0)
  crypto    Float    @default(0)
  gold      Float    @default(0)
  silver    Float    @default(0)
  misc      Float    @default(0)
  notes     String?
  createdAt String   // Store as readable date string like "09/13/25"
  updatedAt String   // Store as readable date string like "09/13/25"

  @@unique([month, year])
  @@map("monthly_inputs")
}

// Personal Portfolio - Detailed tracking
model PersonalAsset {
  id          Int      @id @default(autoincrement())
  symbol      String   // e.g., "FXAIX", "GOLD", "SILVER", "CASH"
  name        String   // e.g., "Fidelity 500 Index Fund", "Gold", "Silver", "Bank Account"
  type        AssetType
  quantity    Float    // shares, ounces, dollars, etc.
  currentPrice Float   @default(0) // current market price
  totalValue  Float    @default(0) // quantity * currentPrice
  notes       String?  // Optional notes about the asset
  lastUpdated String   // Store as readable date string like "09/13/25"
  createdAt   String   // Store as readable date string like "09/13/25"
  updatedAt   String   // Store as readable date string like "09/13/25"

  @@unique([symbol])
  @@map("personal_assets")
}

// Solo 401k Trust Portfolio - Detailed tracking
model Solo401kAsset {
  id          Int      @id @default(autoincrement())
  symbol      String   // e.g., "FXAIX", "GOLD", "SILVER"
  name        String   // e.g., "Fidelity 500 Index Fund", "Gold", "Silver"
  type        AssetType
  quantity    Float    // shares, ounces, etc.
  currentPrice Float   @default(0) // current market price
  totalValue  Float    @default(0) // quantity * currentPrice
  notes       String?  // Optional notes about the asset
  lastUpdated String   // Store as readable date string like "09/13/25"
  createdAt   String   // Store as readable date string like "09/13/25"
  updatedAt   String   // Store as readable date string like "09/13/25"

  @@unique([symbol])
  @@map("solo_401k_assets")
}

// Generic activity log table for all database changes (populated by database triggers)
model ActivityLog {
  id          Int      @id @default(autoincrement())
  table_name  String   // Table name that was modified
  record_id   Int      // ID of the record that was modified
  operation   String   // INSERT, UPDATE, or DELETE
  old_values  String?  // JSON string of old values (for UPDATE/DELETE)
  new_values  String?  // JSON string of new values (for INSERT/UPDATE)
  created_at  String   // Timestamp of the change

  @@index([table_name, record_id])
  @@index([created_at])
  @@map("activity_logs")
}

// Income tracking table
model IncomeEntry {
  id          Int      @id @default(autoincrement())
  date        String   // Store as readable date string like "11/10/25"
  income_source String // LDC, Ebay, 3D2A Supplies
  amount      Float
  notes       String?
  createdAt   String   // Store as readable date string like "09/13/25"
  updatedAt   String   // Store as readable date string like "09/13/25"

  @@map("income")
}

// Solo 401k Conversions tracking table
model Solo401kConversion {
  id          Int      @id @default(autoincrement())
  date        String   // Store as readable date string like "11/10/25"
  amount      Float
  notes       String?
  createdAt   String   // Store as readable date string like "09/13/25"
  updatedAt   String   // Store as readable date string like "09/13/25"

  @@map("solo_401k_conversions")
}

enum AssetType {
  CASH
  STOCK
  CRYPTO
  GOLD
  SILVER
  MISC
}

